<script src="https://unpkg.com/vue@3"></script>
<script src="./papaparse.min.js"></script>
<link rel="stylesheet" href="globalStylesheet.css">
<link rel="stylesheet" href="boxAStylesheet.css">

<div id="app">
  <div class="outerDiv">
    <div class="innerDiv">
      <div :class="boxAClass">
        <div @click="firstTabSelected=true" class="tab" :class="{ selectedTab: firstTabSelected}"><span class="topHeading">Urval</span></div>
        <div @click="firstTabSelected=false" class="tab" :class="{ selectedTab: !firstTabSelected}"><span class="topHeading">Översikt</span></div>
        <div v-if="firstTabSelected" class="tabContent firstTabContent">
          <div class="aboveLists heading">
            <span class="heading">Utdelningstillfälle</span><div class="fakeTimeSelectionBox">08:00 2022-03-04 <button>...</button></div>
            <button>G>></button>
          </div>
          <div class="topList">
            <table class="list topList">
              <thead>
                <tr class="headerRow heading">
                  <th>Namn</th>
                  <th>Beredningsform</th>
                  <th style="width:11em">Dos</th>
                  <th style="width:2em">Sta</th>
                  <th style="width:2em">G</th>
                  <th>Info</th>
                  <th style="width:2em">Aut</th>
                  <th style="width:2em">Kyl</th>
                </tr>
              </thead>
              <tbody>
                <tr v-for="row in medicines" class="valueRow">
                  <td><div class="valueCell value">{{row['Namn']}}</div></td>
                  <td><div class="valueCell value">{{row['Beredningsform']}}</div></td>
                  <td><div class="valueCell value">{{row['Styrka']}}</div></td>
                  <td><div class="valueCell value" style="overflow:hidden">
                    <img v-if="row['Leveranstyp']==1" height="21" src="./assets/images/A_Sta_1.png">
                    <img v-if="row['Leveranstyp']==2" height="21" src="./assets/images/A_Sta_2.png">
                  </div></td>
                  <td><div class="valueCell value">{{row['G']}}</div></td>
                  <td><div class="valueCell value">{{row['Kan bytas mot']}}</div></td>
                  <td><div class="valueCell value">{{row['I automat']}}</div></td>
                  <td><div class="valueCell value">{{row['Kylf�rvaras']}}</div></td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="bottomList">
            <table class="list">
              <thead>
                <tr class="headerRow heading">
                  <th></th>
                </tr>
              </thead>
              <tbody>
                <tr class="valueRow">
                  <td>
                    <div class="valueCell value"></div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div v-else class="tabContent secondTabContent">
          <!-- TODO -->
        </div>
      </div>
      <div :class="boxBClass"></div>
      <button class="administrationButton">Till Administrering</button>
    </div>
  </div>
</div>

<script>
  Vue.createApp({
    data() {
      return {
        boxAClass: 'box-A',
        boxBClass: 'box-B',
        selectedTab: 'selectedTab',

        medicines: [],
        medicinesHeaders: [],
        topListHeadings: ['Namn', 'Beredningsform', 'Styrka', 'Leveranstyp', 'Kan bytas mot', 'I automat', 'Kylf�rvaras'],
        firstTabSelected:true,
      }
    },
    mounted() {
      var medicines = [];
      var medicinesHeaders = []
      fetch('./assets/data/Läkemedel.csv')
        .then(response => response.text())
        .then(text => {
          Papa.parse(text, {
            complete: function (results) {
              medicines = results.data;
              medicinesHeaders = results.meta.fields;
            },
            header:true
          });
          this.medicines = medicines;
          this.medicinesHeaders = medicinesHeaders
        })
    }
  }).mount('#app')

</script>